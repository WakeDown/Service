
@model ServiceClaim.Models.Claim
    

@using (Html.BeginForm("ServiceSheetTech", "Claim", FormMethod.Post, new {@id = "StateTechWorkForm", @class = "form-horizontal", role = "form" }))
{
    @Html.HiddenFor(m => m.Id)
    <div class="row">
        <label class="col-lg-2 text-right">Процесс печати восстановлен</label>
        <div class="col-lg-6">
            @Html.RadioButtonFor(m => m.ServiceSheet4Save.ProcessEnabled, true, new { required = "required" }) да&nbsp;&nbsp;&nbsp; @Html.RadioButtonFor(m => m.ServiceSheet4Save.ProcessEnabled, false) нет
            <span class="help-block with-errors"></span>
        </div>
    </div>
    <div class="row">
        <label class="col-lg-2 text-right">Оборудование полностью восстановлено</label>
        <div class="col-lg-6">
            @Html.RadioButtonFor(m => m.ServiceSheet4Save.DeviceEnabled, true, new { required = "required" }) да&nbsp;&nbsp;&nbsp; @Html.RadioButtonFor(m => m.ServiceSheet4Save.DeviceEnabled, false) нет
            <span class="help-block with-errors"></span>
        </div>
    </div>
    <div class="row">
        <label class="col-lg-2 text-right">Необходим заказ ЗИП</label>
        <div class="col-lg-6">
            @Html.RadioButtonFor(m => m.ServiceSheet4Save.ZipClaim, true, new {required = "required"}) да&nbsp;&nbsp;&nbsp; @Html.RadioButtonFor(m => m.ServiceSheet4Save.ZipClaim, false) нет
            <span class="help-block with-errors"></span>
        </div>
    </div>
    <div class="row" id="comment">
        <label class="col-lg-2 text-right">Комментарий</label>
        <div class="col-lg-6">
            @Html.TextAreaFor(m => m.ServiceSheet4Save.Descr, new {@class="form-control", required = "required"})
            <span class="help-block with-errors"></span>
        </div>
    </div>
    <div class="row">
        <label class="col-lg-2 text-right">Счетчик не предусмотрен</label>
        <div class="col-lg-2">
            @Html.RadioButtonFor(m => m.ServiceSheet4Save.NoCounter, true, new {required = "required"}) да&nbsp;&nbsp;&nbsp; @Html.RadioButtonFor(m => m.ServiceSheet4Save.NoCounter, false) нет
            <span class="help-block with-errors"></span>
        </div>
    </div>
    <div class="row" id="counters">
        <label class="col-lg-2 text-right">Счетчик</label>
        <div class="col-lg-2">
            @Html.TextBoxFor(m => m.ServiceSheet4Save.CounterTotal, new {@class = "form-control", placeholder = "Общий"})
            <span class="help-block with-errors"></span>
        </div>
        <div class="col-lg-2">
            @Html.TextBoxFor(m => m.ServiceSheet4Save.CounterMono, new {@class = "form-control", placeholder = "Черно/Белый"})
            <span class="help-block with-errors"></span>
        </div>
        <div class="col-lg-2">
            @Html.TextBoxFor(m => m.ServiceSheet4Save.CounterColor, new { @class = "form-control", placeholder = "Цветной" })
            <span class="help-block with-errors"></span>
        </div>
    </div>
    @*<div class="row">
        <label class="col-lg-2 text-right">Счетчик общий</label>
        <div class="col-lg-2">
            @Html.TextBoxFor(m => m.ServiceSheet4Save.CounterTotal, new { @class = "form-control" , placeholder= "Счетчик общий" })
            <span class="help-block with-errors"></span>
        </div>
    </div>
    <div class="row">
        <label class="col-lg-2 text-right">Счетчик ЧБ</label>
        <div class="col-lg-2">
            @Html.TextBoxFor(m=>m.ServiceSheet4Save.CounterMono, new {@class="form-control", placeholder = "Счетчик ЧБ" })
            <span class="help-block with-errors"></span>
        </div>
    </div>
    <div class="row">
        <label class="col-lg-2 text-right">Счетчик ЦВ</label>
        <div class="col-lg-2">
            @Html.TextBoxFor(m => m.ServiceSheet4Save.CounterColor, new { @class = "form-control", placeholder = "Счетчик ЦВ" })
            <span class="help-block with-errors"></span>
        </div>
    </div>*@
    <div class="row">
        <div class="col-lg-push-2 col-lg-10">
            <button type="submit" class="btn btn-success" value="ServiceSheetSave" name="ServiceSheetSave">Сохранить</button>
            <button type="submit" class="btn btn-danger" value="ServiceSheetCancel" name="ServiceSheetCancel" formnovalidate="formnovalidate">Нет связи с клиентом</button>
            @*<a class="btn btn-danger" data-toggle="modal" data-target="#modalNoTechWork">Нет связи</a>*@
            @*<div id="modalNoTechWork" class="modal fade" role="dialog">
                <div class="modal-dialog modal-sm">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h4 class="modal-title">Ваш комментарий</h4>
                        </div>
                        <div class="modal-body">
                            <p>
                                @Html.TextAreaFor(m => m.ServiceSheet4Save.CounterColor, new { @class = "form-control required-mark", placeholder = "Введите комментарий" })                                
                            </p>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" class="btn btn-default" value="ServiceSheetCancel" name="ServiceSheetCancel" formnovalidate="formnovalidate">Сохранить</button>
                        </div>
                    </div>
                </div>
            </div>*@
        </div>
    </div>
    <div class="row">
        <div class="col-lg-push-2 col-lg-10">
            <p class="text-danger">@TempData["ServerError"]</p>
        </div>
    </div>
}
@*Подобная форма ServiceSheet*@


    <script type="text/javascript">
        $(function () {
            displayComment();

            $('[name="ServiceSheet4Save.NoCounter"]').change(displayCounters);
            $('[name="ServiceSheet4Save.CounterUnavailable"]').change(displayCounters);
            $('[name="ServiceSheet4Save.ProcessEnabled"]').change(function () {
                displayComment();
                var res = $('[name="ServiceSheet4Save.ProcessEnabled"]:checked').attr('value') === 'True';
                if (!res) {
                    $('[name="ServiceSheet4Save.DeviceEnabled"][value="False"]').attr('checked', 'checked');
                }
            });
            $('[name="ServiceSheet4Save.DeviceEnabled"]').change(function () {
                displayComment();
                checkCounterRequired();
                //var devEnab = $('[name="ServiceSheet4Save.DeviceEnabled"]:checked').attr('value') === 'True';

                //if (devEnab) {
                //    $('#counterUnavailableContainer').hide();
                //} else {
                //    $('#counterUnavailableContainer').show();
                //}
            });
            $('[name="ServiceSheet4Save.ZipClaim"]').change(function () {
                displayComment();
            });
        });

        function checkCounterRequired() {
            $('#ServiceSheet4Save.CounterTotal').prop('required', false);
            var devEnab = $('[name="ServiceSheet4Save.ProcessEnabled"]:checked').attr('value') === 'True';
            var noCounter = $('[name="ServiceSheet4Save.NoCounter"]:checked').attr('value') === 'True';
            if (devEnab && !noCounter) {
                $('#ServiceSheet4Save.CounterTotal').prop('required', true);
            }
        }

        function displayCounters() {
            $('#countersContainer').show();
            var counterUav = $('[name="ServiceSheet4Save.CounterUnavailable"]:checked').attr('value') === 'True';
            var noCounter = $('[name="ServiceSheet4Save.NoCounter"]:checked').attr('value') === 'True';
            if (noCounter || counterUav) {
                $('#countersContainer').hide();
            }
        }

        function displayComment() {
            $('#commentContainer').hide();
            var procDisab = $('[name="ServiceSheet4Save.ProcessEnabled"]:checked').attr('value') === 'False';
            var devDisab = $('[name="ServiceSheet4Save.DeviceEnabled"]:checked').attr('value') === 'False';
            var zipNotCl = $('[name="ServiceSheet4Save.ZipClaim"]:checked').attr('value') === 'False';

            if (procDisab && devDisab && zipNotCl) {
                $('#commentContainer').show();
                $('#comment').attr('placeholder', 'Укажите что случилось');
            }
            var zipCl = $('[name="ServiceSheet4Save.ZipClaim"]:checked').attr('value') === 'True';
            if (zipCl) {
                $('#commentContainer').show();
                $('#comment').attr('placeholder', 'Укажите список ЗИП');
            }
        }
    </script>

